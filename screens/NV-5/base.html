<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>System Logs & Audit - Printer Management</title>
  <style>
    :root {
      --bg: #f7f7fb;
      --card: #ffffff;
      --border: #e5e7eb;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #2563eb;
      --accent-2: #10b981;
      --danger: #dc2626;
      --warn: #f59e0b;
      --shadow: 0 12px 30px -18px rgba(15, 23, 42, 0.4);
      font-family: "Inter", system-ui, -apple-system, sans-serif;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      display: grid;
      grid-template-rows: 72px 1fr;
      grid-template-columns: 260px 1fr;
      grid-template-areas:
        "sidebar header"
        "sidebar main";
      min-height: 100vh;
    }
    header {
      grid-area: header;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      background: var(--card);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow);
      z-index: 10;
    }
    .brand { display: flex; align-items: center; gap: 12px; font-weight: 700; font-size: 18px; }
    .brand span { color: var(--muted); font-weight: 500; }
    .actions { display: flex; align-items: center; gap: 16px; }
    .icon-btn {
      width: 40px; height: 40px; display: grid; place-items: center;
      border-radius: 10px; border: 1px solid var(--border); background: var(--card);
      cursor: pointer; transition: 0.2s ease;
    }
    .icon-btn:hover { border-color: var(--accent); }
    .user-menu {
      display: flex; align-items: center; gap: 10px; padding: 8px 12px;
      border: 1px solid var(--border); border-radius: 12px; background: var(--card);
      cursor: pointer; transition: 0.2s ease; min-width: 160px;
    }
    .user-menu:hover { border-color: var(--accent); }
    .avatar {
      width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #2563eb, #10b981);
      color: #fff; display: grid; place-items: center; font-weight: 700;
    }
    .user-meta { display: flex; flex-direction: column; line-height: 1.2; }
    .user-meta small { color: var(--muted); }
    aside {
      grid-area: sidebar;
      background: #0f172a;
      color: #e2e8f0;
      display: flex;
      flex-direction: column;
      padding: 20px 16px;
      gap: 16px;
      position: sticky;
      top: 0;
      height: 100vh;
    }
    nav { display: flex; flex-direction: column; gap: 6px; }
    .nav-item {
      padding: 12px 14px; border-radius: 10px; color: inherit; text-decoration: none;
      display: flex; align-items: center; gap: 10px; transition: 0.2s ease;
    }
    .nav-item:hover, .nav-item.active { background: rgba(59, 130, 246, 0.15); color: #fff; }
    .sidebar-footer {
      margin-top: auto; padding: 12px 14px; border-radius: 10px;
      background: rgba(226, 232, 240, 0.05); color: #cbd5e1; font-size: 13px; line-height: 1.5;
    }
    main { grid-area: main; padding: 28px 28px 40px; display: flex; flex-direction: column; gap: 20px; }
    .page-title { font-size: 28px; font-weight: 700; margin: 0; }
    .sub { color: var(--muted); margin-top: 6px; }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 18px;
      box-shadow: var(--shadow);
    }
    .warning-banner {
      padding: 14px 18px; border-radius: 10px; display: flex; align-items: center; justify-content: space-between;
      gap: 12px; margin-bottom: 20px; position: relative;
    }
    .warning-banner.warning { background: #fffbeb; border: 1px solid #fcd34d; color: #92400e; }
    .warning-banner.error { background: #fef2f2; border: 1px solid #fecaca; color: #b91c1c; }
    .warning-banner-close {
      width: 28px; height: 28px; border: none; background: transparent; cursor: pointer;
      border-radius: 6px; display: grid; place-items: center; font-size: 18px; color: inherit;
      transition: 0.2s ease;
    }
    .warning-banner-close:hover { background: rgba(0,0,0,0.1); }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; }
    .stat-card {
      background: var(--card); border: 1px solid var(--border); border-radius: 14px;
      padding: 20px; box-shadow: var(--shadow); display: flex; align-items: center; gap: 16px;
    }
    .stat-icon {
      width: 56px; height: 56px; border-radius: 12px; display: grid; place-items: center;
      font-size: 24px; flex-shrink: 0;
    }
    .stat-icon.blue { background: rgba(37, 99, 235, 0.1); color: #2563eb; }
    .stat-icon.red { background: rgba(220, 38, 38, 0.1); color: #dc2626; }
    .stat-icon.yellow { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }
    .stat-content { flex: 1; }
    .stat-label { font-size: 12px; font-weight: 600; color: var(--muted); text-transform: uppercase; margin-bottom: 6px; }
    .stat-value { font-size: 32px; font-weight: 700; margin: 0; line-height: 1; }
    .filter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 16px; }
    .filter-group.search-group { grid-column: span 2; }
    @media (max-width: 768px) {
      .filter-group.search-group { grid-column: span 1; }
    }
    .filter-group { display: flex; flex-direction: column; gap: 6px; }
    .filter-label { font-size: 12px; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; }
    .filter-input, .filter-select {
      padding: 10px 12px; border: 1px solid var(--border); border-radius: 10px; font-size: 14px;
      background: var(--card); color: var(--text); transition: 0.2s ease;
    }
    .filter-input:focus, .filter-select:focus {
      outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    .search-input-wrapper {
      position: relative; display: flex; align-items: center;
    }
    .search-icon {
      position: absolute; left: 12px; color: var(--muted); pointer-events: none;
      width: 16px; height: 16px; display: inline-block;
      border: 2px solid currentColor; border-radius: 50%;
      transform: rotate(-45deg);
    }
    .search-icon::after {
      content: ""; position: absolute; right: -4px; bottom: -4px;
      width: 6px; height: 2px; background: currentColor;
      transform: rotate(45deg);
    }
    .search-input-wrapper .filter-input { padding-left: 40px; width: 100%; min-width: 300px; }
    .filter-actions {
      display: flex; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);
    }
    .btn {
      border: none; border-radius: 10px; cursor: pointer; transition: 0.2s ease;
      padding: 12px 16px; font-weight: 600; display: inline-flex; align-items: center; gap: 6px;
    }
    .btn-primary { background: linear-gradient(135deg, #2563eb, #3b82f6); color: #fff; box-shadow: var(--shadow); }
    .btn-secondary { border: 1px solid var(--border); background: #f8fafc; color: var(--text); }
    .btn-sm { padding: 8px 12px; font-size: 12px; }
    .table-container {
      background: var(--card); border: 1px solid var(--border); border-radius: 14px;
      overflow: hidden; box-shadow: var(--shadow);
    }
    .table-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 18px 20px; border-bottom: 1px solid var(--border); background: #f8fafc;
    }
    .table-title { font-size: 16px; font-weight: 700; margin: 0; }
    .table-info { font-size: 13px; color: var(--muted); }
    .logs-table { width: 100%; border-collapse: collapse; }
    .logs-table thead { background: #f8fafc; border-bottom: 2px solid var(--border); }
    .logs-table th {
      padding: 14px 16px; text-align: left; font-size: 12px; font-weight: 600; color: var(--muted);
      text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; user-select: none;
    }
    .logs-table th:hover { background: #f1f5f9; }
    .logs-table th.sortable::after { content: " ‚Üï"; opacity: 0.5; }
    .logs-table th.sort-desc::after { content: " ‚Üì"; opacity: 1; }
    .logs-table th.sort-asc::after { content: " ‚Üë"; opacity: 1; }
    .logs-table td {
      padding: 16px; border-bottom: 1px solid #f1f5f9; font-size: 14px; color: var(--text);
      vertical-align: middle;
    }
    .logs-table tbody tr { cursor: pointer; transition: 0.2s ease; }
    .logs-table tbody tr:hover { background: #fafbfc; }
    .logs-table tbody tr:last-child td { border-bottom: none; }
    .type-badge, .severity-badge {
      padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap; display: inline-block;
    }
    .type-badge.print-job { background: rgba(37, 99, 235, 0.12); color: #1e40af; }
    .type-badge.error { background: rgba(220, 38, 38, 0.12); color: #b91c1c; }
    .type-badge.maintenance { background: rgba(16, 185, 129, 0.12); color: #047857; }
    .type-badge.status-change { background: rgba(245, 158, 11, 0.12); color: #92400e; }
    .type-badge.configuration { background: rgba(139, 92, 246, 0.12); color: #6d28d9; }
    .type-badge.admin-action { background: rgba(107, 114, 128, 0.12); color: #374151; }
    .severity-badge.info { background: rgba(59, 130, 246, 0.12); color: #1e40af; }
    .severity-badge.warning { background: rgba(245, 158, 11, 0.12); color: #92400e; }
    .severity-badge.error { background: rgba(220, 38, 38, 0.12); color: #b91c1c; }
    .severity-badge.critical { background: rgba(127, 29, 29, 0.15); color: #7f1d1d; }
    .description-cell { max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .empty-state {
      text-align: center; padding: 60px 20px; background: var(--card);
      border: 1px solid var(--border); border-radius: 14px; box-shadow: var(--shadow);
    }
    .empty-icon {
      width: 64px; height: 64px; margin: 0 auto 16px; opacity: 0.3;
      display: flex; align-items: center; justify-content: center;
      font-size: 32px; color: var(--muted);
    }
    .empty-icon::before { content: "üìÑ"; font-size: 48px; }
    .empty-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; }
    .empty-text { font-size: 14px; color: var(--muted); margin-bottom: 16px; }
    .loading-state {
      text-align: center; padding: 60px 20px; background: var(--card);
      border: 1px solid var(--border); border-radius: 14px; box-shadow: var(--shadow);
    }
    .spinner {
      width: 40px; height: 40px; border: 4px solid #f1f5f9; border-top-color: var(--accent);
      border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .pagination {
      display: flex; justify-content: space-between; align-items: center;
      padding: 16px 20px; background: var(--card); border: 1px solid var(--border);
      border-radius: 14px; box-shadow: var(--shadow); flex-wrap: wrap; gap: 12px;
    }
    .pagination-info { font-size: 13px; color: var(--muted); }
    .pagination-controls { display: flex; align-items: center; gap: 8px; }
    .pagination-btn {
      padding: 6px 12px; border: 1px solid var(--border); border-radius: 6px; background: var(--card);
      cursor: pointer; font-size: 13px; font-weight: 500; color: var(--text); transition: 0.2s ease;
    }
    .pagination-btn:hover:not(:disabled) { border-color: var(--accent); color: var(--accent); }
    .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .pagination-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
    .page-size-select { padding: 6px 10px; border: 1px solid var(--border); border-radius: 6px; font-size: 13px; }
    .modal {
      position: fixed; inset: 0; background: rgba(15, 23, 42, 0.55); display: none;
      align-items: center; justify-content: center; padding: 16px; z-index: 1000;
    }
    .modal.active { display: flex; }
    .modal-body {
      background: var(--card); border-radius: 12px; padding: 32px; width: min(900px, 100%);
      max-height: 90vh; overflow-y: auto; box-shadow: 0 24px 60px -30px rgba(0, 0, 0, 0.45);
    }
    .modal-header {
      display: flex; justify-content: space-between; align-items: flex-start;
      margin-bottom: 32px; padding-bottom: 20px; border-bottom: 2px solid var(--border);
    }
    .modal-title { font-size: 24px; font-weight: 700; margin: 0 0 8px 0; color: var(--text); }
    .modal-subtitle { font-size: 14px; color: var(--muted); margin: 0; }
    .log-id-badge {
      display: inline-block; padding: 4px 10px; background: #f1f5f9; color: var(--muted);
      border-radius: 6px; font-family: monospace; font-size: 12px; margin-top: 8px;
    }
    .modal-close {
      width: 36px; height: 36px; border: 1px solid var(--border); background: var(--card);
      border-radius: 8px; cursor: pointer; display: grid; place-items: center;
      font-size: 18px; color: var(--muted); transition: 0.2s ease;
    }
    .modal-close:hover { border-color: var(--text); color: var(--text); background: #f8fafc; }
    .modal-section {
      display: flex; flex-direction: column; gap: 16px;
      margin-bottom: 32px; padding-bottom: 24px; border-bottom: 1px solid #f1f5f9;
    }
    .modal-section:last-of-type { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
    .modal-section-title {
      font-size: 15px; font-weight: 600; color: var(--text);
      margin: 0 0 4px 0; text-transform: none; letter-spacing: 0;
    }
    .modal-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 0;
      background: #fafbfc; border-radius: 8px; padding: 4px; border: 1px solid #f1f5f9;
    }
    .modal-row {
      display: flex; flex-direction: column; padding: 12px 16px;
      background: var(--card); border-radius: 6px; margin: 4px;
    }
    .modal-label {
      font-size: 12px; color: var(--muted);
      margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.3px; font-weight: 500;
    }
    .modal-value {
      font-size: 15px; font-weight: 600; color: var(--text);
      text-align: left; line-height: 1.4; word-break: break-word;
    }
    .modal-footer {
      display: flex; justify-content: flex-end; gap: 12px;
      padding-top: 24px; margin-top: 24px; border-top: 2px solid var(--border);
    }
    .json-code {
      background: #1f2937; color: #e5e7eb; padding: 12px; border-radius: 8px;
      font-family: 'Courier New', monospace; font-size: 12px; overflow-x: auto;
      white-space: pre-wrap; word-break: break-all;
    }
    .actions-list { list-style: disc; padding-left: 20px; margin: 8px 0; }
    .actions-list li { margin-bottom: 4px; color: var(--text); }
    .icon-text { display: inline-block; margin-right: 4px; }
    .radio-option {
      display: flex; align-items: center; gap: 12px; padding: 12px;
      border: 2px solid var(--border); border-radius: 8px; cursor: pointer;
      transition: 0.2s ease; margin-bottom: 12px;
    }
    .radio-option:hover { border-color: var(--accent); background: #f8fafc; }
    .radio-option input[type="radio"] { margin: 0; cursor: pointer; }
    .radio-option.selected { border-color: var(--accent); background: #eef2ff; }
    .export-warning {
      padding: 12px; background: #fffbeb; border: 1px solid #fcd34d;
      border-radius: 8px; color: #92400e; margin: 12px 0;
      display: none;
    }
    .export-warning.show { display: block; }
    @media (max-width: 1024px) {
      body { grid-template-columns: 82px 1fr; }
      aside { width: 82px; padding: 16px 10px; }
      .nav-item span { display: none; }
      .sidebar-footer { display: none; }
    }
    @media (max-width: 768px) {
      body { grid-template-areas: "header header" "main main"; grid-template-columns: 1fr; }
      aside { display: none; }
      .table-container { overflow-x: auto; }
      .logs-table { min-width: 800px; }
      .filter-grid { grid-template-columns: 1fr; }
      .modal-body { padding: 24px; }
      .modal-grid { grid-template-columns: 1fr; }
      .modal-header { flex-direction: column; gap: 16px; }
      .modal-close { align-self: flex-end; }
    }
  </style>
</head>
<body>
  <aside>
    <nav aria-label="Main navigation">
      <a class="nav-item" href="#"><span>Dashboard</span></a>
      <a class="nav-item" href="#"><span>Printers</span></a>
      <a class="nav-item" href="#"><span>Print Jobs</span></a>
      <a class="nav-item active" href="#"><span>System Logs</span></a>
      <a class="nav-item" href="#"><span>Settings</span></a>
    </nav>
    <div class="sidebar-footer">
      <div>¬© 2025 HCMSIU</div>
      <div>Contact: support@siu.edu</div>
      <div>Version: 1.0.0</div>
    </div>
  </aside>

  <header>
    <div class="brand">
      <div class="avatar" aria-hidden="true">SIU</div>
      <div>
        Printer Management System
        <span>‚Üí System Logs & Audit</span>
      </div>
    </div>
    <div class="actions">
      <button class="icon-btn" aria-label="Notifications" title="Notifications" style="font-size: 16px; font-weight: 600;">N</button>
      <div class="user-menu" aria-haspopup="menu" aria-expanded="false">
        <div class="avatar" aria-hidden="true">ST</div>
        <div class="user-meta">
          <strong>Staff Name</strong>
          <small>Administrator</small>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div>
      <h1 class="page-title">System Logs & Audit</h1>
      <div class="sub">View and search system logs for troubleshooting and auditing</div>
    </div>

    <!-- Warning Banner -->
    <div class="warning-banner error" id="warning-banner" style="display: none;">
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 20px; font-weight: 700;">‚ö†</span>
        <span id="warning-text">[X] error(s) and [Y] warning(s) in the system. Please review.</span>
      </div>
      <button class="warning-banner-close" id="close-warning" aria-label="Close warning">√ó</button>
    </div>

    <!-- Statistics Cards -->
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon blue">üìä</div>
        <div class="stat-content">
          <div class="stat-label">Total Records</div>
          <div class="stat-value" id="stat-total">0</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon red">‚úï</div>
        <div class="stat-content">
          <div class="stat-label">Errors</div>
          <div class="stat-value" id="stat-errors">0</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon yellow">‚ö†</div>
        <div class="stat-content">
          <div class="stat-label">Warnings</div>
          <div class="stat-value" id="stat-warnings">0</div>
        </div>
      </div>
    </section>

    <!-- Filter Section -->
    <section class="card">
      <div class="filter-grid">
        <div class="filter-group search-group">
          <label class="filter-label">Search</label>
          <div class="search-input-wrapper">
            <span class="search-icon"></span>
            <input type="text" class="filter-input" id="search-input" placeholder="Search by printer, description, error code..." />
          </div>
        </div>
        <div class="filter-group">
          <label class="filter-label">Type</label>
          <select class="filter-select" id="filter-type">
            <option value="all">All Types</option>
            <option value="print_job">Print Job</option>
            <option value="error">Error</option>
            <option value="maintenance">Maintenance</option>
            <option value="status_change">Status Change</option>
            <option value="configuration">Configuration</option>
            <option value="admin_action">Admin Action</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Severity</label>
          <select class="filter-select" id="filter-severity">
            <option value="all">All Levels</option>
            <option value="info">Info</option>
            <option value="warning">Warning</option>
            <option value="error">Error</option>
            <option value="critical">Critical</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Date From</label>
          <input type="date" class="filter-input" id="date-from" placeholder="From date" />
        </div>
        <div class="filter-group">
          <label class="filter-label">Date To</label>
          <input type="date" class="filter-input" id="date-to" placeholder="To date" />
        </div>
      </div>
      <div class="filter-actions">
        <button class="btn btn-primary" id="apply-filters">Apply</button>
        <button class="btn btn-secondary" id="clear-filters">Clear</button>
      </div>
    </section>

    <!-- Table Section -->
    <section class="table-container">
      <div class="table-header">
        <div>
          <h3 class="table-title">Log Entries</h3>
          <div class="table-info" id="table-info">Showing 0-0 of 0 entries</div>
        </div>
        <button class="btn btn-secondary btn-sm" id="export-btn">Export</button>
      </div>
      <div id="loading-state" class="loading-state" style="display: none;">
        <div class="spinner"></div>
        <div>Loading logs...</div>
      </div>
      <div id="empty-state" class="empty-state" style="display: none;">
        <div class="empty-icon"></div>
        <div class="empty-title">No logs found</div>
        <div class="empty-text">Try adjusting your filters or search criteria</div>
        <button class="btn btn-secondary" onclick="clearAllFilters()">Clear Filters</button>
      </div>
      <table class="logs-table" id="logs-table">
        <thead>
          <tr>
            <th class="sortable sort-desc" data-sort="timestamp">Timestamp</th>
            <th>Printer</th>
            <th>Type</th>
            <th>Severity</th>
            <th>Description</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="logs-tbody"></tbody>
      </table>
    </section>

    <!-- Pagination -->
    <section class="pagination">
      <div class="pagination-info" id="pagination-info">Page 1 of 1</div>
      <div class="pagination-controls">
        <select class="page-size-select" id="page-size-select">
          <option value="10" selected>10 per page</option>
          <option value="25">25 per page</option>
          <option value="50">50 per page</option>
          <option value="100">100 per page</option>
        </select>
        <button class="pagination-btn" id="first-page" disabled title="First page">‚èÆ</button>
        <button class="pagination-btn" id="prev-page" disabled title="Previous page">‚óÄ</button>
        <span id="page-numbers"></span>
        <button class="pagination-btn" id="next-page" disabled title="Next page">‚ñ∂</button>
        <button class="pagination-btn" id="last-page" disabled title="Last page">‚è≠</button>
      </div>
    </section>
  </main>

  <!-- Log Detail Modal -->
  <div class="modal" id="log-modal">
    <div class="modal-body">
      <div class="modal-header">
        <div style="flex: 1;">
          <h2 class="modal-title">Log Details</h2>
          <div class="log-id-badge" id="modal-log-id">LOG-000000</div>
        </div>
        <button class="modal-close" id="close-modal">√ó</button>
      </div>

      <!-- Basic Information -->
      <div class="modal-section">
        <h3 class="modal-section-title">Basic Information</h3>
        <div class="modal-grid">
          <div class="modal-row">
            <span class="modal-label">Timestamp</span>
            <span class="modal-value" id="modal-timestamp">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Log Type</span>
            <span class="modal-value" id="modal-type">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Severity</span>
            <span class="modal-value" id="modal-severity">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Status</span>
            <span class="modal-value" id="modal-status">‚Äî</span>
          </div>
        </div>
      </div>

      <!-- Printer Information -->
      <div class="modal-section">
        <h3 class="modal-section-title">Printer Information</h3>
        <div class="modal-grid">
          <div class="modal-row">
            <span class="modal-label">Printer ID</span>
            <span class="modal-value" id="modal-printer-id">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Location</span>
            <span class="modal-value" id="modal-location">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Printer Name</span>
            <span class="modal-value" id="modal-printer-name">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Serial Number</span>
            <span class="modal-value" id="modal-serial">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">IP Address</span>
            <span class="modal-value" id="modal-ip">‚Äî</span>
          </div>
        </div>
      </div>

      <!-- Description & Details -->
      <div class="modal-section">
        <h3 class="modal-section-title">Description & Details</h3>
        <div style="margin-bottom: 12px;">
          <span class="modal-label">Description</span>
          <div class="modal-value" id="modal-description" style="white-space: pre-wrap; margin-top: 8px;">‚Äî</div>
        </div>
        <div id="modal-error-code-container" style="display: none; margin-bottom: 12px;">
          <span class="modal-label">Error Code</span>
          <span class="severity-badge error" id="modal-error-code">‚Äî</span>
        </div>
        <div id="modal-additional-details-container" style="display: none;">
          <span class="modal-label">Additional Details</span>
          <div class="json-code" id="modal-additional-details">‚Äî</div>
        </div>
      </div>

      <!-- Print Information -->
      <div class="modal-section" id="modal-print-section" style="display: none;">
        <h3 class="modal-section-title">Print Information</h3>
        <div class="modal-grid">
          <div class="modal-row">
            <span class="modal-label">Print Job ID</span>
            <span class="modal-value" id="modal-job-id">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">User</span>
            <span class="modal-value" id="modal-user">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Pages Printed</span>
            <span class="modal-value" id="modal-pages-printed">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">File Name</span>
            <span class="modal-value" id="modal-file-name">‚Äî</span>
          </div>
        </div>
      </div>

      <!-- Resolution Information -->
      <div class="modal-section" id="modal-resolution-section" style="display: none;">
        <h3 class="modal-section-title">Resolution Information</h3>
        <div class="modal-grid">
          <div class="modal-row">
            <span class="modal-label">Resolved At</span>
            <span class="modal-value" id="modal-resolved-at">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Resolved By</span>
            <span class="modal-value" id="modal-resolved-by">‚Äî</span>
          </div>
        </div>
        <div style="margin-top: 12px;">
          <span class="modal-label">Resolution Notes</span>
          <div class="modal-value" id="modal-resolution-notes" style="white-space: pre-wrap; margin-top: 8px;">‚Äî</div>
        </div>
        <div id="modal-actions-taken-container" style="display: none; margin-top: 12px;">
          <span class="modal-label">Actions Taken</span>
          <ul class="actions-list" id="modal-actions-taken"></ul>
        </div>
      </div>

      <!-- Datetime -->
      <div class="modal-section">
        <h3 class="modal-section-title">Datetime</h3>
        <div class="modal-grid">
          <div class="modal-row">
            <span class="modal-label">Created At</span>
            <span class="modal-value" id="modal-created-at">‚Äî</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Last Updated</span>
            <span class="modal-value" id="modal-updated-at">‚Äî</span>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" id="modal-close-btn">Close</button>
        <button class="btn btn-primary" id="modal-resolve-btn" style="display: none;">Mark as Resolved</button>
        <button class="btn" style="background: #fef3c7; color: #92400e; border: 1px solid #fcd34d;" id="modal-note-btn">Add Note</button>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div class="modal" id="export-modal">
    <div class="modal-body" style="width: min(600px, 100%);">
      <div class="modal-header">
        <div style="flex: 1;">
          <h2 class="modal-title">Export Logs</h2>
          <div class="modal-subtitle" id="export-subtitle">Export <span id="export-count">0</span> logs currently displayed?</div>
        </div>
        <button class="modal-close" id="close-export-modal">√ó</button>
      </div>

      <div class="modal-section" style="margin-bottom: 24px;">
        <h3 class="modal-section-title">Export Summary</h3>
        <div class="modal-grid">
          <div class="modal-row">
            <span class="modal-label">Total Logs</span>
            <span class="modal-value" id="export-total-logs">0</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Date Range</span>
            <span class="modal-value" id="export-date-range">All time</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Type Filter</span>
            <span class="modal-value" id="export-type-filter">All Types</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Severity Filter</span>
            <span class="modal-value" id="export-severity-filter">All Levels</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Search Keyword</span>
            <span class="modal-value" id="export-search-keyword">None</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Sort By</span>
            <span class="modal-value" id="export-sort-by">Timestamp (Newest first)</span>
          </div>
        </div>
      </div>

      <div style="margin: 24px 0;">
        <label class="modal-label" style="margin-bottom: 12px; display: block;">Format</label>
        <div class="radio-option" data-format="excel">
          <input type="radio" name="export-format" value="excel" id="export-excel" checked />
          <div style="flex: 1;">
            <div style="font-weight: 600; margin-bottom: 4px;">Excel (max 1000 records)</div>
            <div style="font-size: 12px; color: var(--muted);">Includes Summary and Logs sheets with full data</div>
          </div>
        </div>
        <div class="radio-option" data-format="pdf">
          <input type="radio" name="export-format" value="pdf" id="export-pdf" />
          <div style="flex: 1;">
            <div style="font-weight: 600; margin-bottom: 4px;">PDF (max 100 records)</div>
            <div style="font-size: 12px; color: var(--muted);">Formatted report with summary and log entries</div>
          </div>
        </div>
      </div>

      <div class="export-warning" id="export-warning">
        <strong>‚ö† Cannot export <span id="export-warning-count">0</span> logs to <span id="export-warning-format">PDF</span>.</strong>
        <div style="margin-top: 8px;">Maximum: <span id="export-warning-max">100</span> records.</div>
        <div style="margin-top: 4px; font-size: 13px;">Please either apply filters or switch to <span id="export-warning-suggestion">Excel format (max 1000)</span>.</div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancel-export-btn">Cancel</button>
        <button class="btn btn-primary" id="confirm-export-btn">Export</button>
      </div>
    </div>
  </div>

  <script>
    // Mock Data
    const mockLogs = [
      {
        log_id: 'log-001',
        timestamp: '2024-12-09T14:32:00',
        printer_location: 'LB-101',
        printer_name: 'HP LaserJet Pro M404dn',
        printer_id: 'printer-001',
        printer_serial: 'HP123456',
        printer_ip: '192.168.1.101',
        log_type: 'print_job',
        severity: 'info',
        description: 'Print job completed successfully. Document: Assignment_Report.pdf, Pages: 15',
        error_code: null,
        status: 'resolved',
        job_id: 'job-001',
        user_name: 'Nguy·ªÖn VƒÉn A',
        user_id: 'user-001',
        pages_printed: 15,
        file_name: 'Assignment_Report.pdf',
        resolved_at: '2024-12-09T14:35:00',
        resolved_by: 'Tr·∫ßn Th·ªã B (Administrator)',
        resolution_notes: 'Job completed without issues.',
        actions_taken: ['Verified print quality', 'Confirmed completion'],
        created_at: '2024-12-09T14:32:00',
        updated_at: '2024-12-09T14:35:00',
        additional_details: null
      },
      {
        log_id: 'log-002',
        timestamp: '2024-12-09T13:15:00',
        printer_location: 'SCI-202',
        printer_name: 'Canon imageCLASS MF445dw',
        printer_id: 'printer-002',
        printer_serial: 'CN789012',
        printer_ip: '192.168.1.202',
        log_type: 'error',
        severity: 'error',
        description: 'Hardware malfunction detected: toner unit error. Printer unable to print.',
        error_code: 'E-TONER-001',
        status: 'in_progress',
        job_id: null,
        user_name: null,
        user_id: null,
        pages_printed: null,
        file_name: null,
        resolved_at: null,
        resolved_by: null,
        resolution_notes: null,
        actions_taken: null,
        created_at: '2024-12-09T13:15:00',
        updated_at: '2024-12-09T13:15:00',
        additional_details: JSON.stringify({ error_type: 'hardware', component: 'toner_unit', severity_level: 'high' }, null, 2)
      },
      {
        log_id: 'log-003',
        timestamp: '2024-12-09T12:00:00',
        printer_location: 'CS1-H1-102',
        printer_name: 'Brother HL-L2375',
        printer_id: 'printer-003',
        printer_serial: 'BR345678',
        printer_ip: '192.168.1.103',
        log_type: 'maintenance',
        severity: 'info',
        description: 'Scheduled maintenance completed. Replaced paper tray and cleaned print head.',
        error_code: null,
        status: 'resolved',
        job_id: null,
        user_name: null,
        user_id: null,
        pages_printed: null,
        file_name: null,
        resolved_at: '2024-12-09T12:30:00',
        resolved_by: 'L√™ VƒÉn C (Technician)',
        resolution_notes: 'Maintenance completed successfully. Printer tested and operational.',
        actions_taken: ['Replaced paper tray', 'Cleaned print head', 'Tested print quality'],
        created_at: '2024-12-09T12:00:00',
        updated_at: '2024-12-09T12:30:00',
        additional_details: null
      },
      {
        log_id: 'log-004',
        timestamp: '2024-12-09T11:45:00',
        printer_location: 'LB-101',
        printer_name: 'HP LaserJet Pro M404dn',
        printer_id: 'printer-001',
        printer_serial: 'HP123456',
        printer_ip: '192.168.1.101',
        log_type: 'status_change',
        severity: 'warning',
        description: 'Printer status changed from Available to Busy. Queue length: 5 jobs.',
        error_code: null,
        status: 'new',
        job_id: null,
        user_name: null,
        user_id: null,
        pages_printed: null,
        file_name: null,
        resolved_at: null,
        resolved_by: null,
        resolution_notes: null,
        actions_taken: null,
        created_at: '2024-12-09T11:45:00',
        updated_at: '2024-12-09T11:45:00',
        additional_details: null
      },
      {
        log_id: 'log-005',
        timestamp: '2024-12-09T10:30:00',
        printer_location: 'SCI-202',
        printer_name: 'Canon imageCLASS MF445dw',
        printer_id: 'printer-002',
        printer_serial: 'CN789012',
        printer_ip: '192.168.1.202',
        log_type: 'configuration',
        severity: 'info',
        description: 'Printer configuration updated: Paper size settings changed to A4 default.',
        error_code: null,
        status: 'resolved',
        job_id: null,
        user_name: 'Ph·∫°m Th·ªã D',
        user_id: 'user-002',
        pages_printed: null,
        file_name: null,
        resolved_at: '2024-12-09T10:35:00',
        resolved_by: 'Ph·∫°m Th·ªã D (Administrator)',
        resolution_notes: 'Configuration change applied successfully.',
        actions_taken: ['Updated paper size settings'],
        created_at: '2024-12-09T10:30:00',
        updated_at: '2024-12-09T10:35:00',
        additional_details: JSON.stringify({ setting: 'paper_size', old_value: 'A3', new_value: 'A4' }, null, 2)
      }
    ];

    // State
    const state = {
      logs: [...mockLogs],
      filteredLogs: [...mockLogs],
      currentPage: 1,
      pageSize: 10,
      sortField: 'timestamp',
      sortOrder: 'desc',
      filters: {
        search: '',
        type: 'all',
        severity: 'all',
        dateFrom: null,
        dateTo: null
      },
      selectedLog: null,
      searchTimeout: null
    };

    // Helper functions
    function formatTimestamp(dateStr) {
      if (!dateStr) return '‚Äî';
      const date = new Date(dateStr);
      return date.toLocaleString('en-US', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      }).replace(',', '');
    }

    function formatTimestampFull(dateStr) {
      if (!dateStr) return '‚Äî';
      const date = new Date(dateStr);
      return date.toLocaleString('en-US', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      }).replace(',', '');
    }

    function truncateText(text, maxLength = 80) {
      if (!text) return '‚Äî';
      return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
    }

    function getTypeBadge(type) {
      const map = {
        'print_job': { class: 'print-job', text: 'Print Job' },
        'error': { class: 'error', text: 'Error' },
        'maintenance': { class: 'maintenance', text: 'Maintenance' },
        'status_change': { class: 'status-change', text: 'Status Change' },
        'configuration': { class: 'configuration', text: 'Configuration' },
        'admin_action': { class: 'admin-action', text: 'Admin Action' }
      };
      const item = map[type] || { class: '', text: type };
      return `<span class="type-badge ${item.class}">${item.text}</span>`;
    }

    function getSeverityBadge(severity) {
      const map = {
        'info': { class: 'info', icon: '‚Ñπ', text: 'Info' },
        'warning': { class: 'warning', icon: '‚ö†', text: 'Warning' },
        'error': { class: 'error', icon: '‚úï', text: 'Error' },
        'critical': { class: 'critical', icon: '‚óè', text: 'Critical' }
      };
      const item = map[severity] || { class: '', icon: '', text: severity };
      return `<span class="severity-badge ${item.class}">${item.icon} ${item.text}</span>`;
    }

    function getStatusBadge(status) {
      const map = {
        'new': { bg: '#eef2ff', color: '#1e40af', text: 'New' },
        'in_progress': { bg: '#fef3c7', color: '#92400e', text: 'In Progress' },
        'resolved': { bg: '#d1fae5', color: '#047857', text: 'Resolved' },
        'closed': { bg: '#f3f4f6', color: '#374151', text: 'Closed' }
      };
      const item = map[status] || { bg: '#f3f4f6', color: '#374151', text: status };
      return `<span style="padding: 4px 10px; border-radius: 6px; background: ${item.bg}; color: ${item.color}; font-size: 11px; font-weight: 600;">${item.text}</span>`;
    }

    // Filter and sort
    function applyFilters() {
      let filtered = [...state.logs];

      // Search filter
      if (state.filters.search) {
        const search = state.filters.search.toLowerCase();
        filtered = filtered.filter(log =>
          log.printer_location.toLowerCase().includes(search) ||
          log.description.toLowerCase().includes(search) ||
          (log.error_code && log.error_code.toLowerCase().includes(search))
        );
      }

      // Type filter
      if (state.filters.type !== 'all') {
        filtered = filtered.filter(log => log.log_type === state.filters.type);
      }

      // Severity filter
      if (state.filters.severity !== 'all') {
        filtered = filtered.filter(log => log.severity === state.filters.severity);
      }

      // Date filters
      if (state.filters.dateFrom) {
        const from = new Date(state.filters.dateFrom);
        from.setHours(0, 0, 0, 0);
        filtered = filtered.filter(log => new Date(log.timestamp) >= from);
      }

      if (state.filters.dateTo) {
        const to = new Date(state.filters.dateTo);
        to.setHours(23, 59, 59, 999);
        filtered = filtered.filter(log => new Date(log.timestamp) <= to);
      }

      // Sort
      filtered.sort((a, b) => {
        const aVal = a[state.sortField];
        const bVal = b[state.sortField];
        if (state.sortOrder === 'asc') {
          return aVal > bVal ? 1 : -1;
        } else {
          return aVal < bVal ? 1 : -1;
        }
      });

      state.filteredLogs = filtered;
      updateStatistics();
      renderLogs();
    }

    function updateStatistics() {
      const logs = state.filteredLogs;
      const total = logs.length;
      const errors = logs.filter(l => l.severity === 'error' || l.severity === 'critical').length;
      const warnings = logs.filter(l => l.severity === 'warning').length;

      document.getElementById('stat-total').textContent = total;
      document.getElementById('stat-errors').textContent = errors;
      document.getElementById('stat-warnings').textContent = warnings;

      // Update warning banner
      const banner = document.getElementById('warning-banner');
      const warningText = document.getElementById('warning-text');
      if (errors > 0 || warnings > 0) {
        banner.style.display = 'flex';
        banner.className = errors > 0 ? 'warning-banner error' : 'warning-banner warning';
        warningText.textContent = `${errors} error(s) and ${warnings} warning(s) in the system. Please review.`;
      } else {
        banner.style.display = 'none';
      }
    }

    function renderLogs() {
      const start = (state.currentPage - 1) * state.pageSize;
      const end = start + state.pageSize;
      const pageLogs = state.filteredLogs.slice(start, end);
      const tbody = document.getElementById('logs-tbody');
      const table = document.getElementById('logs-table');
      const emptyState = document.getElementById('empty-state');
      const loadingState = document.getElementById('loading-state');

      loadingState.style.display = 'none';

      if (state.filteredLogs.length === 0) {
        table.style.display = 'none';
        emptyState.style.display = 'block';
        return;
      }

      table.style.display = 'table';
      emptyState.style.display = 'none';

      tbody.innerHTML = pageLogs.map(log => `
        <tr data-log-id="${log.log_id}" onclick="showLogDetail('${log.log_id}')">
          <td>${formatTimestamp(log.timestamp)}</td>
          <td>${log.printer_location}</td>
          <td>${getTypeBadge(log.log_type)}</td>
          <td>${getSeverityBadge(log.severity)}</td>
          <td class="description-cell" title="${log.description}">${truncateText(log.description)}</td>
          <td>
            <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); showLogDetail('${log.log_id}')">View</button>
          </td>
        </tr>
      `).join('');

      updatePagination();
    }

    function updatePagination() {
      const total = state.filteredLogs.length;
      const totalPages = Math.ceil(total / state.pageSize);
      const start = total === 0 ? 0 : (state.currentPage - 1) * state.pageSize + 1;
      const end = Math.min(state.currentPage * state.pageSize, total);

      document.getElementById('table-info').textContent = `Showing ${start}-${end} of ${total} entries`;
      document.getElementById('pagination-info').textContent = `Page ${state.currentPage} of ${totalPages}`;

      // Update page numbers
      const pageNumbers = document.getElementById('page-numbers');
      let html = '';
      const maxPages = Math.min(totalPages, 10);
      for (let i = 1; i <= maxPages; i++) {
        html += `<button class="pagination-btn ${i === state.currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
      }
      pageNumbers.innerHTML = html;

      // Update navigation buttons
      document.getElementById('first-page').disabled = state.currentPage === 1;
      document.getElementById('prev-page').disabled = state.currentPage === 1;
      document.getElementById('next-page').disabled = state.currentPage >= totalPages;
      document.getElementById('last-page').disabled = state.currentPage >= totalPages;
    }

    function goToPage(page) {
      state.currentPage = page;
      renderLogs();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function showLogDetail(logId) {
      const log = state.logs.find(l => l.log_id === logId);
      if (!log) return;

      state.selectedLog = log;

      document.getElementById('modal-log-id').textContent = log.log_id.toUpperCase();
      document.getElementById('modal-timestamp').textContent = formatTimestampFull(log.timestamp);
      document.getElementById('modal-type').innerHTML = getTypeBadge(log.log_type);
      document.getElementById('modal-severity').innerHTML = getSeverityBadge(log.severity);
      document.getElementById('modal-status').innerHTML = getStatusBadge(log.status);
      document.getElementById('modal-printer-id').textContent = log.printer_id || '‚Äî';
      document.getElementById('modal-location').textContent = log.printer_location || '‚Äî';
      document.getElementById('modal-printer-name').textContent = log.printer_name || '‚Äî';
      document.getElementById('modal-serial').textContent = log.printer_serial || '‚Äî';
      document.getElementById('modal-ip').textContent = log.printer_ip || '‚Äî';
      document.getElementById('modal-description').textContent = log.description || '‚Äî';
      document.getElementById('modal-created-at').textContent = formatTimestampFull(log.created_at);
      document.getElementById('modal-updated-at').textContent = formatTimestampFull(log.updated_at) || '‚Äî';

      // Error code
      const errorCodeContainer = document.getElementById('modal-error-code-container');
      if (log.error_code) {
        errorCodeContainer.style.display = 'block';
        document.getElementById('modal-error-code').textContent = log.error_code;
      } else {
        errorCodeContainer.style.display = 'none';
      }

      // Additional details
      const additionalDetailsContainer = document.getElementById('modal-additional-details-container');
      if (log.additional_details) {
        additionalDetailsContainer.style.display = 'block';
        document.getElementById('modal-additional-details').textContent = log.additional_details;
      } else {
        additionalDetailsContainer.style.display = 'none';
      }

      // Print information
      const printSection = document.getElementById('modal-print-section');
      if (log.job_id) {
        printSection.style.display = 'block';
        document.getElementById('modal-job-id').innerHTML = `<a href="#" style="color: var(--accent);">${log.job_id}</a>`;
        document.getElementById('modal-user').textContent = log.user_name ? `${log.user_name} (${log.user_id})` : '‚Äî';
        document.getElementById('modal-pages-printed').textContent = log.pages_printed || '‚Äî';
        document.getElementById('modal-file-name').textContent = log.file_name || '‚Äî';
      } else {
        printSection.style.display = 'none';
      }

      // Resolution information
      const resolutionSection = document.getElementById('modal-resolution-section');
      if (log.resolved_at) {
        resolutionSection.style.display = 'block';
        document.getElementById('modal-resolved-at').textContent = formatTimestampFull(log.resolved_at);
        document.getElementById('modal-resolved-by').textContent = log.resolved_by || '‚Äî';
        document.getElementById('modal-resolution-notes').textContent = log.resolution_notes || '‚Äî';
        
        const actionsTakenContainer = document.getElementById('modal-actions-taken-container');
        if (log.actions_taken && log.actions_taken.length > 0) {
          actionsTakenContainer.style.display = 'block';
          document.getElementById('modal-actions-taken').innerHTML = log.actions_taken.map(action => `<li>${action}</li>`).join('');
        } else {
          actionsTakenContainer.style.display = 'none';
        }
      } else {
        resolutionSection.style.display = 'none';
      }

      // Buttons
      document.getElementById('modal-resolve-btn').style.display = log.status !== 'resolved' && log.status !== 'closed' ? 'inline-flex' : 'none';

      document.getElementById('log-modal').classList.add('active');
    }

    function clearAllFilters() {
      document.getElementById('search-input').value = '';
      document.getElementById('filter-type').value = 'all';
      document.getElementById('filter-severity').value = 'all';
      document.getElementById('date-from').value = '';
      document.getElementById('date-to').value = '';
      state.filters = { search: '', type: 'all', severity: 'all', dateFrom: null, dateTo: null };
      state.currentPage = 1;
      applyFilters();
    }

    // Event listeners
    document.getElementById('apply-filters').addEventListener('click', () => {
      state.filters.search = document.getElementById('search-input').value;
      state.filters.type = document.getElementById('filter-type').value;
      state.filters.severity = document.getElementById('filter-severity').value;
      state.filters.dateFrom = document.getElementById('date-from').value || null;
      state.filters.dateTo = document.getElementById('date-to').value || null;
      state.currentPage = 1;
      applyFilters();
    });

    document.getElementById('clear-filters').addEventListener('click', clearAllFilters);

    document.getElementById('search-input').addEventListener('input', (e) => {
      clearTimeout(state.searchTimeout);
      state.searchTimeout = setTimeout(() => {
        state.filters.search = e.target.value;
        state.currentPage = 1;
        applyFilters();
      }, 500);
    });

    document.getElementById('close-warning').addEventListener('click', () => {
      document.getElementById('warning-banner').style.display = 'none';
    });

    document.getElementById('close-modal').addEventListener('click', () => {
      document.getElementById('log-modal').classList.remove('active');
    });

    document.getElementById('modal-close-btn').addEventListener('click', () => {
      document.getElementById('log-modal').classList.remove('active');
    });

    document.querySelectorAll('.logs-table th.sortable').forEach(th => {
      th.addEventListener('click', () => {
        const field = th.dataset.sort;
        if (state.sortField === field) {
          if (state.sortOrder === 'desc') {
            state.sortOrder = 'asc';
          } else if (state.sortOrder === 'asc') {
            state.sortOrder = 'desc';
          }
        } else {
          state.sortField = field;
          state.sortOrder = 'desc';
        }
        
        // Update UI
        document.querySelectorAll('.logs-table th').forEach(h => {
          h.classList.remove('sort-asc', 'sort-desc');
        });
        th.classList.add(`sort-${state.sortOrder}`);
        
        applyFilters();
      });
    });

    document.getElementById('first-page').addEventListener('click', () => goToPage(1));
    document.getElementById('prev-page').addEventListener('click', () => goToPage(state.currentPage - 1));
    document.getElementById('next-page').addEventListener('click', () => goToPage(state.currentPage + 1));
    document.getElementById('last-page').addEventListener('click', () => {
      const totalPages = Math.ceil(state.filteredLogs.length / state.pageSize);
      goToPage(totalPages);
    });

    document.getElementById('page-size-select').addEventListener('change', (e) => {
      state.pageSize = Number(e.target.value);
      state.currentPage = 1;
      renderLogs();
    });

    // Export modal functions
    function showExportModal() {
      const count = state.filteredLogs.length;
      if (count === 0) {
        alert('No logs to export. Please adjust your filters.');
        return;
      }

      document.getElementById('export-count').textContent = count;
      document.getElementById('export-total-logs').textContent = count;

      // Update filters summary
      const typeText = state.filters.type === 'all' ? 'All Types' : 
        state.filters.type.split('_').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
      document.getElementById('export-type-filter').textContent = typeText;

      const severityText = state.filters.severity === 'all' ? 'All Levels' : 
        state.filters.severity.charAt(0).toUpperCase() + state.filters.severity.slice(1);
      document.getElementById('export-severity-filter').textContent = severityText;

      // Date range - always show
      if (state.filters.dateFrom || state.filters.dateTo) {
        const from = state.filters.dateFrom || 'All time';
        const to = state.filters.dateTo || 'All time';
        document.getElementById('export-date-range').textContent = `${from} to ${to}`;
      } else {
        document.getElementById('export-date-range').textContent = 'All time';
      }

      // Search keyword - always show
      document.getElementById('export-search-keyword').textContent = state.filters.search || 'None';

      // Sort order
      const sortField = state.sortField === 'timestamp' ? 'Timestamp' : 
        state.sortField.charAt(0).toUpperCase() + state.sortField.slice(1);
      const sortOrder = state.sortOrder === 'desc' ? 'Newest first' : 'Oldest first';
      document.getElementById('export-sort-by').textContent = `${sortField} (${sortOrder})`;

      // Check limits
      checkExportLimits();
      document.getElementById('export-modal').classList.add('active');
    }

    function checkExportLimits() {
      const count = state.filteredLogs.length;
      const format = document.querySelector('input[name="export-format"]:checked').value;
      const warning = document.getElementById('export-warning');
      const exportBtn = document.getElementById('confirm-export-btn');

      if (format === 'excel' && count > 1000) {
        warning.classList.add('show');
        document.getElementById('export-warning-count').textContent = count;
        document.getElementById('export-warning-format').textContent = 'Excel';
        document.getElementById('export-warning-max').textContent = '1000';
        document.getElementById('export-warning-suggestion').textContent = 'apply filters to reduce dataset';
        exportBtn.disabled = true;
      } else if (format === 'pdf' && count > 100) {
        warning.classList.add('show');
        document.getElementById('export-warning-count').textContent = count;
        document.getElementById('export-warning-format').textContent = 'PDF';
        document.getElementById('export-warning-max').textContent = '100';
        document.getElementById('export-warning-suggestion').textContent = 'Excel format (max 1000)';
        exportBtn.disabled = true;
      } else {
        warning.classList.remove('show');
        exportBtn.disabled = false;
      }
    }

    function handleExport() {
      const format = document.querySelector('input[name="export-format"]:checked').value;
      const count = state.filteredLogs.length;
      
      if (format === 'excel' && count > 1000) {
        alert('Cannot export more than 1000 records to Excel. Please apply filters.');
        return;
      }
      if (format === 'pdf' && count > 100) {
        alert('Cannot export more than 100 records to PDF. Please apply filters or use Excel format.');
        return;
      }

      // Close modal
      document.getElementById('export-modal').classList.remove('active');

      // Show loading/processing message
      alert(`Exporting ${count} logs to ${format.toUpperCase()}...\n\nThis functionality will be implemented to generate and download the file.`);
      
      // In real implementation, this would make an API call to export the logs
      // fetch('/api/logs/export', { method: 'POST', body: JSON.stringify({ format, filters: state.filters }) })
    }

    document.getElementById('export-btn').addEventListener('click', showExportModal);
    document.getElementById('close-export-modal').addEventListener('click', () => {
      document.getElementById('export-modal').classList.remove('active');
    });
    document.getElementById('cancel-export-btn').addEventListener('click', () => {
      document.getElementById('export-modal').classList.remove('active');
    });
    document.getElementById('confirm-export-btn').addEventListener('click', handleExport);

    // Radio button handlers for export format
    document.querySelectorAll('input[name="export-format"]').forEach(radio => {
      radio.addEventListener('change', () => {
        document.querySelectorAll('.radio-option').forEach(opt => {
          opt.classList.remove('selected');
        });
        radio.closest('.radio-option').classList.add('selected');
        checkExportLimits();
      });
    });

    // Initialize radio options
    document.querySelectorAll('.radio-option').forEach(opt => {
      if (opt.querySelector('input[type="radio"]:checked')) {
        opt.classList.add('selected');
      }
    });

    // Initial render
    applyFilters();
  </script>
</body>
</html>
