@startuml Print Management Module - Component Diagram

!theme plain
skinparam componentStyle rectangle
skinparam linetype ortho
skinparam backgroundColor #FFFFFF

top to bottom direction

title Biểu đồ Thành phần - Module Quản lý In ấn

package "Frontend Layer" #E3F2FD {
  component WebUI
}

package "API Gateway Layer" #FFF9C4 {
  component BackendAPI
}

package "Business Logic Layer" #C8E6C9 {
  component PrintService
  component PricingService
  component PaymentService
  component RefundService
  component DepositService
  component LedgerService
}

package "Infrastructure Layer" #FFE0B2 {
  component PrinterController
  component FileStorage
  component PaymentGateway
  database Database
}

() "REST API" as REST
() "WebSocket" as WS
() "Business" as Business
() "Pricing" as Pricing
() "Payment" as Payment
() "Printer" as Printer
() "File" as File
() "Data" as Data
() "Ledger" as Ledger
() "Gateway" as Gateway
() "Webhook" as Webhook

WebUI --> REST
WebUI --> WS
REST - BackendAPI
WS - BackendAPI

BackendAPI --> Business
Business - PrintService
Business - PricingService
Business - PaymentService
Business - RefundService
Business - DepositService
Business - LedgerService

PrintService --> Pricing
PrintService --> Payment
PrintService --> Printer
PrintService --> File
PrintService --> Data

Pricing - PricingService
Payment - PaymentService
Printer - PrinterController
File - FileStorage
Data - Database

PricingService --> Data
PaymentService --> Ledger
PaymentService --> Gateway
RefundService --> Payment
RefundService --> Ledger
DepositService --> Gateway
DepositService --> Ledger

Ledger - LedgerService
LedgerService --> Data
Gateway - PaymentGateway
PaymentGateway --> Webhook
Webhook --> DepositService

' Force vertical layout to reduce width
WebUI -[hidden]down-> BackendAPI
BackendAPI -[hidden]down-> PrintService
PrintService -[hidden]down-> PricingService
PricingService -[hidden]down-> PaymentService
PaymentService -[hidden]down-> RefundService
RefundService -[hidden]down-> DepositService
DepositService -[hidden]down-> LedgerService
LedgerService -[hidden]down-> PrinterController
PrinterController -[hidden]down-> FileStorage
FileStorage -[hidden]down-> PaymentGateway
PaymentGateway -[hidden]down-> Database

@enduml
